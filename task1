import pandas as pd
gdp = pd.read_csv("GDPC1.csv", skiprows=range(1, 10))  # ヘッダー行の位置によっては調整が必要
gdp['DATE'] = pd.to_datetime(gdp['DATE'])
gdp.set_index('DATE', inplace=True)

import numpy as np
gdp['log_GDP'] = np.log(gdp['GDPC1'])
from statsmodels.tsa.filters.hp_filter import hpfilter

# 例：λ=1600 を用いた場合
cycle, trend = hpfilter(gdp['log_GDP'], lamb=1600)
lambdas = [10, 100, 1600]
trend_components = {}
cycle_components = {}

for lam in lambdas:
    cycle, trend = hpfilter(gdp['log_GDP'], lamb=lam)
    trend_components[lam] = trend
    cycle_components[lam] = cycle
import matplotlib.pyplot as plt

# グラフ1：元のデータとトレンド成分の比較
plt.figure(figsize=(12, 6))
plt.plot(gdp.index, gdp['log_GDP'], label='対数GDP', linewidth=2)
for lam in lambdas:
    plt.plot(gdp.index, trend_components[lam], label=f"トレンド (λ={lam})")
plt.title("対数GDPとトレンド成分の比較")
plt.xlabel("年")
plt.ylabel("対数GDP")
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.savefig("trend_plot.png")  # ←追加
plt.show()

# グラフ2：循環成分の比較
plt.figure(figsize=(12, 6))
for lam in lambdas:
    plt.plot(gdp.index, cycle_components[lam], label=f"循環成分 (λ={lam})")
plt.title("循環成分の比較")
plt.xlabel("年")
plt.ylabel("対数GDPの循環成分")
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.savefig("cycle_plot.png")  # ←追加
plt.show()

plt.savefig("trend_plot.png")   # トレンド比較グラフ
plt.savefig("cycle_plot.png")   # 循環成分グラフ




